---
title: "ADA Final Project EDA"
subtitle: "Airbnb in the city of New York"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: inverse
background-image: url(https://upload.wikimedia.org/wikipedia/commons/6/69/Airbnb_Logo_B%C3%A9lo.svg)

```{r setup, include=FALSE}
# setup
knitr::opts_chunk$set(
  # cache = TRUE, 
  # cache.lazy = FALSE, 
  echo = F
  , comment=""
  , warning = FALSE
  , message = FALSE
  , tidy.opts=list(width.cutoff=55)
  , tidy = TRUE
  )

# rm(list=ls())
# update.packages(ask = FALSE, checkBuilt = TRUE)
library(DT); library(data.table)
library(tidyverse)
library(plotly)
library(wordcloud2); library(tm); library(jiebaR,jiebaRD) 
library(leaflet,quietly=TRUE); library(maps,quietly=TRUE)
library(Hmisc)

options(
  htmltools.dir.version = FALSE, 
  dev='cairo_pdf'
  )
```

```{r}
# constants
price.name <- "price"
price.group.name <- "price group"
cuts.price <- seq(0, 1000, 125)
```

```{r}
data <- dat <- fread("MyData.csv")
dat[, eval(price.group.name) := as.factor(as.character(cut2(x = get(price.name), cuts = cuts.price)))]
# colnames(dat)
```

---
class: inverse, center, middle

# Data Source

SKDJbv:Sruvbn:SEIgjtkb.nLFIuvb;

---
class: inverse, center, middle 

# Exploratory Data Analysis

---
## Wordcloud
```{r out.width='100%'}
freq <- table(readRDS("description.rds"))
wordcloud2(freq,shape='star')
# letterCloud(demoFreq,"R")
# wordcloud2(freq, figPath = "peace.png", size = 1.5, color = "skyblue", backgroundColor="black")
```

---
## Sunburst
```{r out.width='100%'}
boroughs <- aggregate(dat$id,list(dat$neighbourhood_group_cleansed),length)
plot_ly(labels=boroughs[,1], values=boroughs[,2], type = "pie",textinfo = "label+percent"
           ) %>%
      layout(title = paste("Proportion By Boroughs"),showlegend = F,
             xaxis=list(showgrid=F,zeroline=F,showline=F,autotick=T,ticks='',showticklabels=F),
             yaxis=list(showgrid=F,zeroline=F,showline=F,autotick=T,ticks='',showticklabels=F))
```

---
class: center, middle 
## Map
```{r  out.width='100%', fig.height=6, eval=require('leaflet')}
# no layer map
pal <- colorFactor(palette = 'YlOrBr', domain = dat$`price group`)
pop <- paste0("<strong>Name: </strong>",
                dat$name, "<br>",
                "<strong>Neighbourhood: </strong>",
                dat$neighbourhood_cleansed, "<br>",
                "<strong>Room Type: </strong>",
                dat$room_type, "</br>",
                "<strong>Beds: </strong>",
                dat$beds, "<br>",
                "<strong>Price: </strong>",
                dat$price)
dat %>%
  leaflet() %>%
  addTiles(urlTemplate = "http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png")  %>%
  mapOptions(zoomToLimits="always") %>%
  addCircles(~longitude, ~latitude, color = ~pal(dat$`price group`), weight = 3, opacity = 0.7,popup = pop, group = "rooms") -> map_nolayer
```

